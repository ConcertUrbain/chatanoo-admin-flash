package org.concert_urbain.touratour.api.core.requests{	import com.adobe.serialization.json.JSON;	import com.adobe.serialization.json.JSONEncoder;		import flash.net.URLRequest;	import flash.net.URLRequestHeader;	import flash.net.URLRequestMethod;		import org.concert_urbain.touratour.api.TAT;	public class AbstractServiceRequest	{		// STATIC FUNCTION				protected static function generateID():String		{			var num:int = 24;			var char:Array = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'.split('');			var uiid:String = "";			for(var i:uint = 0; i < num; i++)			{				uiid += char[Math.floor(Math.random() * char.length)];				if(i%4 == 3 && i != 0 && i < num - 1)					uiid += '-';			}			return uiid;		}				//////////////////				private var _id:String;		protected var _service:String;		protected var _method:String;				public var params:Array;				public function AbstractServiceRequest()		{			_id			params = [];		}				public function getJSONRequest():URLRequest		{			var url:URLRequest = new URLRequest(TAT.getInstance().url + "/services/" + _service + "/json");			url.method = URLRequestMethod.POST;			url.requestHeaders = [new URLRequestHeader("Content-Type", "application/json")];						if(TAT.getInstance().sessionKey && TAT.getInstance().sessionKey != "")				url.requestHeaders.push(new URLRequestHeader("Authorization", TAT.getInstance().sessionKey));											var data:Object = {				method: method,				params: params,				id: generateID()			};			url.data = com.adobe.serialization.json.JSON.encode(data);						return url;		}				// GETTER				public function get id():String		{			return _id;		}				public function get service():String		{			return _service;		}				public function get method():String		{			return _method;		}	}}